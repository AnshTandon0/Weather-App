(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"UD/I":function(i,e,n){"use strict";n.r(e),e.default=".scrolling-wrapper {\n  overflow-x: auto;\n  overflow-y: hidden;\n  white-space: nowrap;\n}\n\n.textWrap {\n  display: -webkit-box;\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-height: 21px;\n}\n\n.wide-as-needed {\n  overflow: scroll;\n  white-space: nowrap;\n}\n\nion-label h4 {\n  margin: 0 0 0px;\n  padding-top: 4px;\n}\n\nion-card {\n  border-radius: 8px;\n}\n\nion-card-subtitle {\n  text-align: center;\n}\n\ninput[type=file] {\n  display: none;\n}\n\n.custom-file-upload {\n  border: 1px solid #ccc;\n  display: inline-block;\n  padding: 6px 12px;\n  cursor: pointer;\n}\n\nion-button {\n  cursor: pointer;\n}\n\n.card {\n  cursor: pointer;\n  display: inline-block;\n  margin-right: 10px;\n  margin-bottom: 10px;\n  margin-top: 8px;\n}\n\n.ion-text-wrap {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  min-height: 40px;\n}\n\n.breadcrumRow ion-button {\n  --padding-start: 3px;\n  --padding-end: 3px;\n}\n\nion-list ion-card {\n  margin-inline: 0px;\n}\n\nion-button label {\n  height: 33px;\n  padding-top: 9px;\n  padding-inline: 10px;\n}\n\nion-fab-button label {\n  font-size: 35px;\n  line-height: 0;\n}\n\n.border-circle {\n  border-radius: 50%;\n  -webkit-border-radius: 50%;\n  -moz-border-radius: 50%;\n  -ms-border-radius: 50%;\n  -o-border-radius: 50%;\n}\n\n.border-circle label {\n  font-size: 25px;\n  line-height: 0;\n  padding-top: 5px;\n}"},Urq9:function(i,e,n){"use strict";n.r(e),e.default='<ion-header>\r\n        <ion-toolbar>\r\n            <ion-title color="tertiary">\r\n                <strong> {{file.Name}} </strong>\r\n\r\n            </ion-title>\r\n            <ion-buttons slot="start">\r\n                <ion-button (click)="dismiss()" color="dark" fill="clear" shape="round" size="small">\r\n                    <ion-icon ios="arrow-back" md="arrow-back"></ion-icon>\r\n                </ion-button>\r\n            </ion-buttons>\r\n        </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-grid class="ion-text-center" *ngIf="file.Ext !== \'pdf\'">\r\n    <ion-row>\r\n      <ion-col >\r\n        <img  [src]="data" />\r\n      </ion-col>\r\n\r\n    </ion-row>\r\n  </ion-grid>\r\n  <embed  *ngIf="file.Ext == \'pdf\'" [src]="data" width="100%" height="100%" />\r\n  \x3c!-- <img src="" *ngIf=" docExt==png || docExt==jpg" />\r\n  <embed src="http://example.com/the.pdf" width="500" height="375" type="application/pdf" *ngIf="docExt==pdf"> --\x3e\r\n</ion-content>'},nQDz:function(i,e,n){"use strict";n.r(e),e.default='<ion-header>\r\n    <ion-toolbar>\r\n        <ion-buttons slot="start">\r\n            <ion-menu-button></ion-menu-button>\r\n        </ion-buttons>\r\n        <ion-title></ion-title>\r\n    </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content class="ion-padding">\r\n    <ion-grid [fixed]="true" *ngIf="!drive_storage_check">\r\n        <ion-row *ngIf="isShowHideFolderGrid">\r\n            <ion-toolbar>\r\n                <ion-title color="tertiary">\r\n                    <strong> All Folders </strong>\r\n                </ion-title>\r\n                <ion-buttons slot="start">\r\n                    <ion-button (click)="isShowHideFolderGrid=false" color="dark" fill="clear" shape="round" size="small">\r\n                        <ion-icon ios="arrow-back" md="arrow-back"></ion-icon>\r\n                    </ion-button>\r\n                </ion-buttons>\r\n            </ion-toolbar>\r\n\r\n        </ion-row>\r\n\r\n        <ion-row>\r\n            <ion-col size="12" size-md="9" *ngIf="currentDirectory != \'/\' && !isShowHideFolderGrid">\r\n                <ion-toolbar>\r\n                    <ion-text class="breadcrumRow" color="primary " *ngFor="let item of breadcrumbs" scrollable>\r\n                        <ion-button (click)="listDirectoryFiles(\'\',\'/\')" size="default" color="primary" fill="clear" shape="round" *ngIf="item.path==\'/\'">\r\n                            DigiLocker Drive\r\n                        </ion-button>\r\n                        <ion-button size="default" color="primary" fill="clear" shape="round" *ngIf="item.path!=\'/\'">\r\n                            <ion-icon name="chevron-forward-outline"></ion-icon>\r\n                        </ion-button>\r\n                        <ion-button size="default" color="primary" fill="clear" shape="round" (click)="listDirectoryFiles(item.name,item.path)" *ngIf="item.path!=\'/\'">\r\n                            {{item.name}}\r\n                        </ion-button>\r\n\r\n                    </ion-text>\r\n                    <ion-buttons slot="start">\r\n                        <ion-button (click)="navigateBack()" color="dark" fill="clear" shape="round" size="small">\r\n                            <ion-icon ios="arrow-back" md="arrow-back"></ion-icon>\r\n                        </ion-button>\r\n                    </ion-buttons>\r\n                </ion-toolbar>\r\n            </ion-col>\r\n            <ion-col size="12" size-md="9" *ngIf="currentDirectory == \'/\' && !isShowHideFolderGrid">\r\n                <ion-text color="tertiary">\r\n                    <h2><strong>\r\n                            {{"Digilocker" | translate}} {{"Drive" | translate}}\r\n                        </strong>\r\n                    </h2>\r\n                </ion-text>\r\n\r\n                <ion-text>\r\n\r\n                    <h4>{{"Documents in DigiLocker Drive are NOT treated as authentic original documents." | translate}}\r\n                    </h4>\r\n\r\n                </ion-text>\r\n\r\n            </ion-col>\r\n            <ion-col size="2" size-md="3" *ngIf="!isShowHideFolderGrid && infiniteFileList.length >0 && deviceSize">\r\n                <ion-button color="primary" class="ion-margin-top-md ion-float-end ion-no-padding ">\r\n                    <label for="file-upload" class="cursor"> {{"Upload Files" | translate}}\r\n                    </label>\r\n                    <input id="file-upload" type="file" accept="image/png, image/jpeg, application/pdfimage/png, image/jpeg, application/pdf" [(ngModel)]="fileUpload" (change)="loadImageFromDevice($event)" />\r\n                </ion-button>\r\n            </ion-col>\r\n\r\n        </ion-row>\r\n        <ion-row *ngIf="directoryList.length > 0">\r\n            <ion-col>\r\n                <ion-row class="ion-no-padding" *ngIf="!isShowHideFolderGrid">\r\n                    <ion-col size="7" class="ion-no-margin ion-no-padding">\r\n                        <ion-label class="textWrap" color="tertiary">\r\n                            <h4 class="text-primary"><strong>Folders</strong></h4>\r\n                        </ion-label>\r\n                    </ion-col>\r\n                    <ion-col size="5" class="ion-no-margin ion-no-padding ion-text-right" *ngIf="!isShowHideFolderGrid">\r\n                        <ion-button color="dark" fill="clear" size="small" shape="round" (click)="isShowHideFolderGrid = true" *ngIf="directoryList.length > 5">\r\n                            View All ({{directoryList.length}})\r\n                        </ion-button>\r\n\r\n                    </ion-col>\r\n                </ion-row>\r\n                <div class="scrolling-wrapper ion-margin-bottom" *ngIf="!isShowHideFolderGrid">\r\n                    <div class="card" *ngFor="let file of directoryList">\r\n                        <ion-card mode="ios" class="ion-no-margin" title="{{file.Name}}" (click)="listDirectoryFiles(file.Name)">\r\n                            <ion-item lines="none">\r\n                                <ion-icon name="folder" color="warning" slot="start" title="{{file.Name}}"></ion-icon>\r\n                                <ion-label>{{file.Name}}</ion-label>\r\n                            </ion-item>\r\n\r\n                        </ion-card>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class="ion-margin-bottom showGrid" *ngIf="isShowHideFolderGrid">\r\n                    <ion-row>\r\n                        <ion-card class="card" title="{{file.Name}}" (click)="listDirectoryFiles(file.Name)" *ngFor="let file of directoryList">\r\n                            <ion-card-header>\r\n                                <ion-card-subtitle>\r\n                                    <ion-icon size="large" name="folder" color="warning">\r\n                                    </ion-icon>\r\n\r\n                                </ion-card-subtitle>\r\n                            </ion-card-header>\r\n                            <ion-card-content class="ion-text-center">\r\n                                <ion-label color="dark" class="ion-text-wrap">{{file.Name}}</ion-label>\r\n                            </ion-card-content>\r\n                        </ion-card>\r\n                    </ion-row>\r\n                </div>\r\n\r\n            </ion-col>\r\n        </ion-row>\r\n        <ion-row *ngIf="!isShowHideFolderGrid ">\r\n            <ion-col>\r\n\r\n                <ion-row class="ion-no-padding" *ngIf=" infiniteFileList.length >0">\r\n                    <ion-col size="10" class="ion-no-margin ion-no-padding">\r\n                        <ion-label class="textWrap" color="tertiary" style="padding-top: 5px;">\r\n                            <h4 class="text-primary"><strong>{{"Files" | translate}} {{(fileList.length>10)?\'- (\'+fileList.length+\')\':\'\'}}</strong></h4>\r\n                        </ion-label>\r\n                    </ion-col>\r\n\r\n                    <ion-col size="2" class="ion-no-margin ion-no-padding">\r\n                        <ion-select [(ngModel)]="sortByFlag" placeholder="Sort by" interface="popover" mode="ios" (ionChange)="onSortChange($event)" class="ion-float-end"> \r\n\r\n                            <ion-select-option value="-LastModified">Newest\r\n                            </ion-select-option>\r\n                            <ion-select-option value="LastModified">Oldest\r\n                            </ion-select-option>\r\n                            <ion-select-option value="Name">A-Z Name </ion-select-option>\r\n                            <ion-select-option value="-Name">Z-A Name\r\n                            </ion-select-option>\r\n\r\n\r\n                        </ion-select>\r\n\r\n\r\n                    </ion-col>\r\n                </ion-row>\r\n                <ion-list>\r\n                    <ion-card *ngFor="let file of fileList; let i = index" class="ion-no-margin ion-margin-bottom" mode="ios">\r\n                        <ion-item lines="none">\r\n\r\n                            <ion-icon color="primary" name="image-outline" slot="start" *ngIf="!file.Ext.includes(\'pdf\')"></ion-icon>\r\n                            <ion-icon color="primary" name="document-outline" slot="start" *ngIf="file.Ext.includes(\'pdf\')">\r\n                            </ion-icon>\r\n                            <ion-label style="cursor: pointer;" (click)="readFile(file)">{{file.Name}} <br>\r\n                                \x3c!--<small color="secondary">{{file.LastModified | date : "dd-MM-YYYY HH:mm:ss"}},\r\n                                    {{file.human_size}} </small>--\x3e\r\n                            </ion-label>\r\n\r\n                            <ion-button color="dark" fill="clear" size="small" shape="round" title="Download" class="ion-float-right" (click)="downloadPdf(file)">\r\n                                <ion-icon color="primary" name="download-outline"></ion-icon>\r\n                            </ion-button>\r\n                            <ion-button color="dark" fill="clear" size="small" shape="round" title="Edit" class="ion-float-right" (click)="updateFile(file)">\r\n                                <ion-icon name="create-outline"></ion-icon>\r\n                            </ion-button>\r\n\r\n                            <ion-button color="dark" fill="clear" size="small" shape="round" title="Delete" class="ion-float-right" (click)="deleteFile(file)">\r\n                                <ion-icon color="danger" name="trash-outline"></ion-icon>\r\n                            </ion-button>\r\n\r\n                        </ion-item>\r\n\r\n\r\n                    </ion-card>\r\n                </ion-list>\r\n                \x3c!--<ion-infinite-scroll (ionInfinite)="doInfinite($event)" *ngIf="infiniteFileList.length > 0">\r\n                    <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">\r\n                    </ion-infinite-scroll-content>\r\n                </ion-infinite-scroll>--\x3e\r\n\r\n                <ion-row *ngIf="fileList.length==0 && showTashBin">\r\n                    <ion-col size-md="8" offset-md="2" size="12">\r\n                        <ion-row class="ion-no-margin">\r\n                            <ion-col class="ion-text-center">\r\n                                <img src="https://img1.digitallocker.gov.in/assets/img/icons/empty-drive.svg" alt="Empty Drive">\r\n                            </ion-col>\r\n                        </ion-row>\r\n                        <ion-text color="dark" class=" ion-text-center ion-text-wrap">\r\n                            <h1>There are no files in your drive yet..</h1>\r\n                        </ion-text>\r\n                        <ion-text class="ion-text-center ion-text-wrap">\r\n                            <h3>Let\'s add some documents</h3>\r\n                        </ion-text>\r\n                        <ion-title class="ion-text-center ion-margin-top">\r\n                            <ion-button color="primary">\r\n\r\n                                <label for="file-upload"> Upload Files</label>\r\n                                <input id="file-upload" type="file" accept="image/png, image/jpeg, application/pdfimage/png, image/jpeg, application/pdf" (change)="loadImageFromDevice($event)" />\r\n\r\n                            </ion-button>\r\n                        </ion-title>\r\n                    </ion-col>\r\n                </ion-row>\r\n            </ion-col>\r\n        </ion-row>\r\n    </ion-grid>\r\n    <ion-grid [fixed]="true" *ngIf="drive_storage_check">\r\n        <ion-row>\r\n            <ion-col size-md="8" offset-md="2" size="12">\r\n                <ion-row class="ion-no-margin">\r\n                    <ion-col class="ion-text-center">\r\n                        <img width="300px" [src]="maintenanceImg">\r\n                    </ion-col>\r\n                </ion-row>\r\n                <ion-text color="dark" class=" ion-text-center ion-margin-top">\r\n                    <h1>We are under Scheduled Maintenance</h1>\r\n                </ion-text>\r\n                <ion-text class="cursor ion-text-center" color="tertiary" routerLink="/home" routerDirection="root">\r\n                    <h1>Go to Home</h1>\r\n                </ion-text>\r\n            </ion-col>\r\n        </ion-row>\r\n    </ion-grid>\r\n\r\n    <ion-grid [fixed]="true" *ngIf="showSkeleton">\r\n        <ion-row>\r\n            <ion-col class="ion-text-start" size="10">\r\n                <ion-text color="tertiary">\r\n                    <h4 class="text-primary"><strong>Folders</strong></h4>\r\n                </ion-text>\r\n            </ion-col>\r\n            <ion-col class="ion-text-end">\r\n                <ion-text color="tertiary">\r\n                    <h3>\r\n                        <ion-skeleton-text animated style="width: 80%"></ion-skeleton-text>\r\n                    </h3>\r\n                </ion-text>\r\n            </ion-col>\r\n        </ion-row>\r\n        <ion-row>\r\n            <ion-col>\r\n                <div class="scrolling-wrapper ion-margin-bottom">\r\n                    <div class="card" style="width: 15%;" *ngFor="let drive of [].constructor(6)">\r\n                        <ion-card mode="ios" class="ion-no-margin">\r\n                            <ion-item lines="none">\r\n                                <ion-avatar slot="start">\r\n                                    <ion-skeleton-text animated></ion-skeleton-text>\r\n                                </ion-avatar>\r\n                                <ion-skeleton-text animated style="width: 90%; height: 15px;"></ion-skeleton-text>\r\n                            </ion-item>\r\n\r\n                        </ion-card>\r\n                    </div>\r\n                </div>\r\n            </ion-col>\r\n        </ion-row>\r\n\r\n        <ion-row>\r\n            <ion-col>\r\n                <ion-row class="ion-no-padding">\r\n                    <ion-col size="10" class="ion-no-margin ion-no-padding">\r\n                        <ion-label class="textWrap" color="tertiary" style="padding-top: 5px;">\r\n                            <h4 class="text-primary"><strong>{{"Files" | translate}}</strong></h4>\r\n                        </ion-label>\r\n                    </ion-col>\r\n                    <ion-col size="2" class="ion-no-margin ion-no-padding">\r\n                        <ion-select placeholder="Sort by" interface="popover" mode="ios" (ionChange)="onSortChange($event)" class="ion-float-end">\r\n                            <ion-select-option (click)="sortListData(\'-LastModified\')" value="-LastModified">Newest\r\n                            </ion-select-option>\r\n                            <ion-select-option (click)="sortListData(\'LastModified\')" value="LastModified">Oldest\r\n                            </ion-select-option>\r\n                            <ion-select-option (click)="sortListData(\'Name\')" value="Name">A-Z Name </ion-select-option>\r\n                            <ion-select-option (click)="sortListData(\'-Name\')" value="-Name">Z-A Name\r\n                            </ion-select-option>\r\n                        </ion-select>\r\n                    </ion-col>\r\n                </ion-row>\r\n                <ion-list>\r\n                    <ion-card *ngFor="let drive of [].constructor(10)" class="ion-no-margin ion-margin-bottom" mode="ios">\r\n                        <ion-item lines="none">\r\n                            <ion-avatar slot="start">\r\n                                <ion-skeleton-text animated></ion-skeleton-text>\r\n                            </ion-avatar>\r\n                            <ion-label style="cursor: pointer;">\r\n                                <ion-skeleton-text animated style="width: 90%;"></ion-skeleton-text>\r\n                            </ion-label>\r\n                            <ion-icon name="ellipse" color="light"></ion-icon>\r\n                            <ion-icon name="ellipse" color="light"></ion-icon>\r\n                            <ion-icon name="ellipse" color="light"></ion-icon>\r\n                        </ion-item>\r\n                    </ion-card>\r\n                </ion-list>\r\n            </ion-col>\r\n        </ion-row>\r\n    </ion-grid>\r\n</ion-content>\r\n<ion-row *ngIf="!deviceSize && !isShowHideFolderGrid && infiniteFileList.length >0">\r\n    <ion-col size="12">\r\n        <ion-fab vertical="bottom" horizontal="end">\r\n            <ion-fab-button color="primary" class="ion-margin-top-md ion-float-end ion-no-padding ">\r\n                <label for="file-upload" class="cursor">\r\n                    <ion-icon name="add-outline"></ion-icon>\r\n                </label>\r\n                <input id="file-upload" type="file" accept="image/png, image/jpeg, application/pdfimage/png, image/jpeg, application/pdf" [(ngModel)]="fileUpload" (change)="loadImageFromDevice($event)" />\r\n            </ion-fab-button>\r\n        </ion-fab>\r\n    </ion-col>\r\n</ion-row>'},qvQA:function(i,e,n){"use strict";n.r(e),e.default=""},sdq4:function(i,e,n){"use strict";n.d(e,"a",(function(){return s}));var t=n("mrSG"),r=n("TEn/"),o=n("fXoL");let s=class{constructor(i){this.modalCtlr=i}ngOnInit(){}dismiss(){this.modalCtlr.dismiss()}};s.ctorParameters=()=>[{type:r.h}],s=Object(t.c)([Object(o.n)({selector:"app-doc-detail",template:Object(t.f)(n("Urq9")).default,styles:[Object(t.f)(n("qvQA")).default]})],s)},wKgE:function(i,e,n){"use strict";n.r(e),n.d(e,"DrivePageModule",(function(){return y}));var t=n("mrSG"),r=n("fXoL"),o=n("ofXK"),s=n("3Pt+"),a=n("sYmb"),l=n("TEn/"),c=n("tyNb"),d=n("9ans"),h=n("AytR"),p=n("sRcL"),u=n("sdq4"),f=n("jhN1");let m=class{constructor(i,e,n,t,r,o,s){this.ajax=i,this.modalController=e,this.alertCtrl=n,this.sanitizer=t,this.titleService=r,this.platform=o,this.auth=s,this.infiniteFileList=[],this.fileList=[],this.directoryList=[],this.fileOffset=0,this.currentDirectory="/",this.previousDirectory="",this.allDirectories=[],this.breadcrumbs=[],this.isShowHideFolderGrid=!1,this.uploadBlobTextData=null,this.showTashBin=!1,this.PAGE_SIZE=15,this.pdfData=null,this.imgData=null,this.fileUpload=null,this.drive_storage_check=!1,this.showSkeleton=!0,this.sortByFlag="-LastModified",this.maintenanceImg=h.a.maintenanceImg,this.fileTypes=["image/jpeg","image/png","image/jpg","application/pdf"],this.fileExt=["jpeg","png","jpg","pdf"],this.deviceSize=this.platform.isLandscape()}ionViewDidEnter(){this.titleService.setTitle("Drive")}ngOnInit(){this.breadcrumbs.push({name:"home",path:"/"}),this.getFiles(this.currentDirectory)}ngAfterViewInit(){}getFiles(i){return Object(t.b)(this,void 0,void 0,(function*(){this.showTashBin=!1;let e={jtoken:this.auth.getToken(),"device-security-id":this.auth.getDeviceId()};this.ajax.getMethod(h.a.drive_storage_check,e).subscribe(e=>{this.showSkeleton=!1,void 0!==e.storage&&"S3"==e.storage?this.getFilesAjax(i):this.drive_storage_check=!0})}))}getFilesAjax(i){return Object(t.b)(this,void 0,void 0,(function*(){this.showSkeleton=!0;var e="";if("/"!=i){var n=i;"/"==i.charAt(0)&&(n=i.slice(1)),e=encodeURI("path="+n)}yield this.ajax.postMethod(h.a.list_files,e,{}).subscribe(e=>{this.showSkeleton=!1,null!=e&&null!=e.data&&(0!=e.data.length?(this.saveFiles(i,e.data),this.fileList=e.data.filter(i=>"collection"!=i.Ext.toLowerCase()),this.onSortChangebyNewest(),this.directoryList=e.data.filter(i=>"collection"==i.Ext.toLowerCase()),this.directoryList.sort(this.dynamicSort("Name")),this.infiniteFileList=[],this.addMoreItems(),0==this.fileList.length?this.showTashBin=!0:this.showTashBin=!1):(this.infiniteFileList=[],this.fileList=[],this.directoryList=[],this.showTashBin=!0))})}))}listDirectoryFiles(i,e=null){this.isShowHideFolderGrid=!1,this.previousDirectory=this.currentDirectory,null!=e?this.currentDirectory="/"==e?"/":e:(e="/"==this.currentDirectory?this.currentDirectory+i:this.currentDirectory+"/"+i,this.currentDirectory=e);let n=this.breadcrumbs.findIndex(i=>i.path==e);if(n>=0){for(let t=0;t<this.breadcrumbs.length;t++)if(t>n&&this.breadcrumbs.splice(t,1),t==n)if(0==n)this.previousDirectory=this.currentDirectory;else{let i=this.breadcrumbs[t-1];this.previousDirectory=i.path}}else{let i=e.split("/").pop();this.breadcrumbs.push({name:i,path:e})}this.fileOffset=0,this.isFileExists(this.currentDirectory)?this.addMoreItems():(this.infiniteFileList=[],this.fileList=[],this.directoryList=[],this.getFiles(this.currentDirectory))}isFileExists(i){var e=this.allDirectories.filter(e=>e.path==i);return e.length>0&&(this.infiniteFileList=[],this.fileList=e[0].files.filter(i=>"collection"!=i.Ext.toLowerCase()),this.directoryList=e[0].files.filter(i=>"collection"==i.Ext.toLowerCase()),this.directoryList.sort(this.dynamicSort("Name")),!0)}deleteVisitedDir(i){this.allDirectories.forEach((e,n)=>{e.path==i&&this.allDirectories.splice(n,1)})}saveFiles(i,e){return this.allDirectories.push({path:i,files:e}),!1}doInfinite(i){var e=this;setTimeout(()=>{this.addMoreItems(),e.fileOffset>=e.fileList.length&&(i.target.disabled=!0)},500)}addMoreItems(){let i=this.fileList;var e;e=this.fileOffset;for(let n=0;n<this.PAGE_SIZE;n++)i[e+n]&&(this.infiniteFileList.push(i[e+n]),this.fileOffset++);0==this.infiniteFileList.length?this.showTashBin=!0:this.showTashBin=!1}downloadPdf(i){var e=this,n="";if("/"!=this.currentDirectory){var t=this.currentDirectory;"/"==this.currentDirectory.charAt(0)&&(t=this.currentDirectory.slice(1)),n=encodeURI("name="+i.Name+"&path="+t)}else n=encodeURI("name="+i.Name);this.ajax.postMethod(h.a.drive_file_download,n,{}).subscribe(n=>{null!=n&&null!=n.Body&&e.downloadFile(n,i)})}readFile(i){if(null!=this.validFileType(i))return void this.ajax.showToast("Download failed.");var e=this;this.currentDirectory.substring(1);var n="";if("/"!=this.currentDirectory){var t=this.currentDirectory;"/"==this.currentDirectory.charAt(0)&&(t=this.currentDirectory.slice(1)),n=encodeURI("name="+i.Name+"&path="+t)}else n=encodeURI("name="+i.Name);this.ajax.showLoader(),this.ajax.postMethod(h.a.drive_file_download,n,{}).subscribe(n=>{this.ajax.hideLoader(),null!=n.Body&&e.viewDetail(i,n.Body)})}deleteFile(i){return Object(t.b)(this,void 0,void 0,(function*(){var e=i;(yield this.showDeleteFileAlert(e))&&this.callDeleteFile(i)}))}updateFile(i){return Object(t.b)(this,void 0,void 0,(function*(){let e=i.Name,n=e.substring(0,e.lastIndexOf(".")),t=yield this.showRenameAlert(n,i.Ext);0!=t&&this.callRenameFile(t,i)}))}showRenameAlert(i,e){return Object(t.b)(this,void 0,void 0,(function*(){return new Promise(n=>Object(t.b)(this,void 0,void 0,(function*(){const t=yield this.alertCtrl.create({header:"Rename File",inputs:[{name:"editFile",placeholder:"Name",value:i}],buttons:[{text:"Cancel",role:"cancel",handler:()=>n(!1)},{text:"Update",handler:r=>{var o="";if(r.editFile==i)return n(!1);if(null!=this.validateFileName(r.editFile)){o=this.validateFileName(r.editFile).msg}else if(null!=this.alreadyExistByName(r.editFile+"."+e)){o=this.alreadyExistByName(r.editFile+"."+e).msg}else if(null==this.validateFileName(r.editFile))return n(r.editFile);if(t.getElementsByClassName("validation-errors").length){t.getElementsByTagName("small")[0].textContent=o}else{const i=t.getElementsByTagName("input")[0],e=document.createElement("div");e.className="validation-errors";const n=document.createElement("small");n.classList.add("error-message"),n.textContent=o,e.appendChild(n),i.insertAdjacentElement("afterend",e)}return!1}}]});yield t.present()})))}))}validateFileName(i){return 0==i.length?{isValid:!1,msg:"Please enter the file name"}:/^[^\\/:\*\?"<>=;#\|+]+$/.test(i)&&!/^\./.test(i)?null:{isValid:!1,msg:"Please enter a valid file name"}}downloadFile(i,e){let n=`data:application/${e.Ext};base64,${i.Body}`;var t=document.createElement("a");t.href=n,t.download=e.Name,t.click()}callDeleteFile(i){var e=i;h.a.drive_delete;var n="";this.currentDirectory.substring(1);if("/"!=this.currentDirectory){var t=this.currentDirectory;"/"==this.currentDirectory.charAt(0)&&(t=this.currentDirectory.slice(1)),n=encodeURI("name="+e.Name+"&path="+t)}else n=encodeURI("name="+e.Name);this.ajax.showLoader(),this.ajax.postMethod(h.a.drive_delete,n,{}).subscribe(i=>{this.ajax.hideLoader(),i.status?(this.ajax.showToast("File deleted successfully"),this.fileOffset=0,this.deleteVisitedDir(this.currentDirectory),this.getFiles(this.currentDirectory)):this.ajax.showToast(i.message)})}showDeleteFileAlert(i){return Object(t.b)(this,void 0,void 0,(function*(){return new Promise(i=>Object(t.b)(this,void 0,void 0,(function*(){const e=yield this.alertCtrl.create({header:"",message:"Are you sure you want to delete?",buttons:[{text:"Cancel",role:"cancel",handler:()=>i(!1)},{text:"Delete",handler:()=>i(!0)}]});yield e.present()})))}))}callRenameFile(i,e){var n=e,t="";if("/"!=this.currentDirectory){this.currentDirectory;var r=this.currentDirectory;"/"==this.currentDirectory.charAt(0)&&(r=this.currentDirectory.slice(1)),t=encodeURI("name="+n.Name+"&new_name="+i+"."+n.Ext+"&path="+r)}else t=encodeURI("name="+n.Name+"&new_name="+i+"."+n.Ext);this.ajax.showLoader(),this.ajax.postMethod(h.a.drive_rename,t,{}).subscribe(i=>{this.ajax.hideLoader(),i.status?(this.ajax.showToast("File renamed successfully"),this.fileOffset=0,this.deleteVisitedDir(this.currentDirectory),this.getFiles(this.currentDirectory)):this.ajax.showToast(i.message)})}navigateBack(){this.listDirectoryFiles("",this.previousDirectory)}refreshAfterDeteleList(i){this.fileList.splice(i,1)}viewDetail(i,e){return Object(t.b)(this,void 0,void 0,(function*(){let n=i.Ext.toLowerCase(),t=["jpg","jpeg"].includes(n)?this.sanitizer.bypassSecurityTrustUrl("data:image/jpg;base64,"+e):["png"].includes(n)?this.sanitizer.bypassSecurityTrustUrl("data:image/png;base64,"+e):["pdf"].includes(n)?this.sanitizer.bypassSecurityTrustResourceUrl("data:application/pdf;base64,"+e):"";return(yield this.modalController.create({component:u.a,swipeToClose:!0,componentProps:{data:t,file:i}})).present()}))}uploadAjaxCall(i){let e=new FormData;if(e.append("body",i),"/"!=this.currentDirectory){var n=this.currentDirectory;"/"==this.currentDirectory.charAt(0)&&(n=this.currentDirectory.slice(1)),e.append("path",n)}this.ajax.showLoader(),this.ajax.uploadMethod(h.a.drive_upload,e).subscribe(e=>{this.ajax.hideLoader(),e.status?(this.onSortChangebyNewest(),this.ajax.showToast("File uploaded successfully",3e3,"success"),this.fileOffset=0,this.deleteVisitedDir(this.currentDirectory),this.getFiles(this.currentDirectory)):null!=e.message?this.ajax.showToast(e.message,3e3,"danger"):this.ajax.showToast("File "+i.name+" could not be uploaded. Please try again.",3e3,"warning")})}loadImageFromDevice(i){var e=i.target.files;if(e.length>0){var n=e[0],t=new FileReader;this.checkFileMimeType(t,i=>{n.type==i?this.alreadyExistByName(n.name.replace(/ /g,""))?this.ajax.showToast("A file with this name already exists",3e3,"danger"):this.validFileSize(n)?this.ajax.showToast("Upload failed. Maximum file size is 10 MB.",3e3,"danger"):this.uploadAjaxCall(n):this.ajax.showToast("Files with extension JPG, JPEG, PDF, PNG are allowed or a currupted file. Please try another file.",3e3,"danger")}),t.readAsArrayBuffer(n),this.fileUpload=null}}checkFileMimeType(i,e){return Object(t.b)(this,void 0,void 0,(function*(){i.onload=function(i){for(var n=new Uint8Array(i.target.result).subarray(0,4),t="",r=0;r<n.length;r++)t+=n[r].toString(16);var o="unknown";switch(t){case"89504e47":o="image/png";break;case"47494638":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":o="image/jpeg";break;case"25504446":o="application/pdf"}e(o)}}))}validFileType(i){return null!=i.type?this.fileTypes.includes(i.type)?null:{isValid:!1,msg:"Upload failed. Files with extension JPG, JPEG, PDF, PNG are allowed."}:null!=i.Ext?this.fileExt.includes(i.Ext.toLowerCase())?null:{isValid:!1,msg:"Upload failed. Files with extension JPG, JPEG, PDF, PNG are allowed."}:null}validFileSize(i){return i.size>10485760?{isValid:!1,msg:"Upload failed. Maximum file size is 10 MB."}:null}alreadyExist(i){for(let e of this.fileList)if(i.name==e.Name)return{isValid:!1,msg:"A file with this name already exists"};return null}alreadyExistByName(i){for(let e of this.fileList)if(i==e.Name)return{isValid:!1,msg:"A file with this name already exists"};return null}onSortChange(){this.fileList.sort(this.dynamicSort(this.sortByFlag))}onSortChangebyNewest(){this.sortByFlag="-LastModified",this.fileList.sort(this.dynamicSort(this.sortByFlag))}dynamicSort(i){var e=1;return"-"===i[0]&&(e=-1,i=i.substr(1)),function(n,t){return-1==e?t[i].localeCompare(n[i]):n[i].localeCompare(t[i])}}};m.ctorParameters=()=>[{type:p.a},{type:l.h},{type:l.a},{type:f.b},{type:f.d},{type:l.k},{type:d.a}],m=Object(t.c)([Object(r.n)({selector:"app-drive",template:Object(t.f)(n("nQDz")).default,styles:[Object(t.f)(n("UD/I")).default]})],m);const g=[{path:"",component:m},{path:"doc-detail",loadChildren:()=>n.e(107).then(n.bind(null,"+3+b")).then(i=>i.DocDetailPageModule)}];let b=class{};b=Object(t.c)([Object(r.M)({imports:[c.i.forChild(g)],exports:[c.i]})],b);let y=class{};y=Object(t.c)([Object(r.M)({imports:[o.b,s.b,l.d,b,a.b.forChild()],declarations:[m]})],y)}}]);